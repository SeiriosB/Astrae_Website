---
layout: default
title: News
---

<section class="news-page">
  <!-- Calendar -->
  <div class="calendar">
    <div class="calendar-header">
      <button onclick="prevMonth()">&lt;</button>
      <h3 id="calendar-month"></h3>
      <button onclick="nextMonth()">&gt;</button>
    </div>
    <div id="calendar-grid" class="calendar-grid"></div>
  </div>

  <!-- News feed -->
  <div class="news-feed">
    <h2>Latest News</h2>
    {% assign news_posts = site.posts | where: "categories", "news" %}
    {% assign sorted_posts = news_posts | sort: "date" %}
    {% for post in sorted_posts %}
      <div class="news-item">
        <div class="news-date">
          {{ post.date | date: "%b %d" }}
        </div>
        <div class="news-content">
          <h4><a href="{{ post.url | relative_url }}">{{ post.title }}</a></h4>
          {% if post.image %}
            <img src="{{ post.image | relative_url }}" alt="{{ post.title }}" class="news-thumb">
          {% endif %}
          <p>{{ post.excerpt | strip_html | truncate: 160 }}</p>
        </div>
      </div>
    {% endfor %}
  </div>
</section>

<!-- Pass posts data into JS -->
<script>
  const posts = [
    {% for post in site.posts %}
      {
        title: {{ post.title | jsonify }},
        url: "{{ post.url | relative_url }}",
        date: "{{ post.date | date: '%Y-%m-%d' }}",
        category: "{{ post.categories | first }}"
      }{% unless forloop.last %},{% endunless %}
    {% endfor %}
  ];
</script>

<script>
  const categoriesColors = {
    news: "green",
    pictures: "purple",
    default: "gray"
  };

  let currentDate = new Date();

  function renderCalendar() {
    const month = currentDate.getMonth();
    const year = currentDate.getFullYear();

    // Month label
    document.getElementById("calendar-month").innerText =
      currentDate.toLocaleString("default", { month: "long" }) + " " + year;

    // First day and days count
    const firstDay = new Date(year, month, 1).getDay();
    const daysInMonth = new Date(year, month + 1, 0).getDate();

    const grid = document.getElementById("calendar-grid");
    grid.innerHTML = "";

    // Empty slots for days before 1st
    for (let i = 0; i < firstDay; i++) {
      grid.appendChild(document.createElement("div"));
    }

    // Actual days
    for (let day = 1; day <= daysInMonth; day++) {
      const cell = document.createElement("div");
      cell.className = "calendar-day";
      cell.innerText = day;

      // Match posts for this date
      const dateKey = `${year}-${String(month+1).padStart(2,'0')}-${String(day).padStart(2,'0')}`;
      const todaysPosts = posts.filter(p => p.date === dateKey);

      if (todaysPosts.length > 0) {
        const dots = document.createElement("div");
        dots.className = "dots";
        todaysPosts.forEach(p => {
          const dot = document.createElement("span");
          dot.style.backgroundColor = categoriesColors[p.category] || categoriesColors.default;
          dot.title = p.title;
          dots.appendChild(dot);
        });
        cell.appendChild(dots);

        // Make date clickable
        cell.onclick = () => {
          window.location.href = todaysPosts[0].url;
        };
        cell.style.cursor = "pointer";
      }

      grid.appendChild(cell);
    }
  }

  function prevMonth() {
    currentDate.setMonth(currentDate.getMonth() - 1);
    renderCalendar();
  }

  function nextMonth() {
    currentDate.setMonth(currentDate.getMonth() + 1);
    renderCalendar();
  }

  document.addEventListener("DOMContentLoaded", renderCalendar);
</script>

<!-- CSS -->
<style>
.news-page {
  display: grid;
  grid-template-columns: 30% 70%;
  gap: 20px;
  padding: 20px;
}

/* Calendar */
.calendar {
  background: #f9f9f9;
  padding: 15px;
  border-radius: 8px;
  border: 1px solid #ddd;
}

.calendar-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
}

.calendar-grid {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 5px;
}

.calendar-day {
  padding: 8px;
  background: #fff;
  border: 1px solid #eee;
  border-radius: 4px;
  text-align: center;
  font-size: 0.9em;
  position: relative;
}

.dots {
  display: flex;
  justify-content: center;
  gap: 2px;
  margin-top: 3px;
}

.dots span {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  display: inline-block;
}

/* News feed */
.news-feed h2 {
  margin-bottom: 20px;
}

.news-item {
  display: flex;
  align-items: flex-start;
  border-bottom: 1px solid #eee;
  padding: 10px 0;
}

.news-date {
  flex: 0 0 80px;
  font-weight: bold;
  color: #444;
}

.news-content {
  flex: 1;
}

.news-content h4 {
  margin: 0;
  font-size: 1.1em;
}

.news-thumb {
  max-width: 100%;
  height: auto;
  border-radius: 6px;
  margin: 8px 0;
}

.news-content p {
  margin: 5px 0 0;
  color: #666;
  font-size: 0.9em;
}
</style>
